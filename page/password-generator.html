<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Password Generator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f4f4f4;
            overflow: hidden;
        }

        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
            width: 400px;
            max-width: 90%;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            max-height: 95vh;
            overflow-y: auto;
        }

        h2 {
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
        }

        label {
            display: block;
            margin-bottom: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .options-group {
            margin-bottom: 15px;
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
        }

        input[type="number"] {
            padding: 5px;
            width: 60px;
            margin-left: 10px;
        }

        input[type="text"] {
            padding: 8px;
            width: 100%;
            box-sizing: border-box;
            margin-top: 5px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        #custom-char-container {
            display: none;
            margin-top: 5px;
            margin-bottom: 10px;
            padding-left: 20px;
        }
        
        .hidden {
            display: none !important;
        }

        button {
            margin-top: 10px;
            padding: 12px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }

        button:hover {
            filter: brightness(0.9);
        }

        .btn-group {
            display: flex;
            gap: 10px;
        }

        #copyBtn {
            background-color: #10b981;
            width: 30%;
        }
        
        #generateBtn {
            width: 70%;
        }

        #password {
            margin-top: 15px;
            font-size: 18px;
            border: 1px solid #ccc;
            padding: 10px;
            width: 100%;
            border-radius: 5px;
            background: #fdfdfd;
            box-sizing: border-box;
            text-align: center;
            font-family: monospace;
            transition: border-color 0.1s;
        }

        @keyframes blink-border {
            0% { border-color: transparent; box-shadow: none; }
            50% { border-color: #10b981; box-shadow: 0 0 8px rgba(16, 185, 129, 0.5); }
            100% { border-color: transparent; box-shadow: none; }
        }

        .blink {
            animation: blink-border 0.4s ease-in-out 2;
        }

        .stats {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
            font-size: 13px;
            color: #555;
            line-height: 1.6;
        }

        .stat-line {
            margin-bottom: 8px;
        }

        .stat-label {
            font-weight: bold;
            color: #333;
        }

        @media (max-width: 600px) {
            body {
                background-color: white;
            }

            .container {
                width: 100%;
                height: 100%;
                max-width: 100%;
                max-height: 100%;
                border-radius: 0;
                border: none;
                padding: 20px;
                justify-content: flex-start;
            }
            
            input[type="checkbox"] {
                transform: scale(1.2);
                margin-right: 10px;
            }

            label {
                padding: 5px 0;
            }
        }

        @media (prefers-color-scheme: dark) {
            body {
                background-color: #121212;
                color: #e0e0e0;
            }

            .container {
                background: #1e1e1e;
                border: 1px solid rgba(255, 255, 255, 0.1);
            }
            
            @media (max-width: 600px) {
                body {
                    background-color: #1e1e1e;
                }
            }

            .options-group {
                background: #2a2a2a;
            }

            input[type="text"],
            input[type="number"],
            #password {
                background-color: #2a2a2a;
                color: #ffffff;
                border: 1px solid #444;
            }

            h2, .stat-label {
                color: #fff;
            }
            
            .stats {
                color: #bbb;
                border-top: 1px solid #333;
            }
        }
    </style>
</head>

<body>

    <div class="container">
        <h2>Password Generator</h2>
        
        <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <label for="length" style="margin-bottom: 0; margin-right: 10px;">Length:</label>
            <input type="number" id="length" value="16" min="1" max="128">
        </div>

        <div class="options-group">
            <label><input type="checkbox" id="uppercase" checked> Include Uppercase (A-Z)</label>
            <label><input type="checkbox" id="lowercase" checked> Include Lowercase (a-z)</label>
            <label><input type="checkbox" id="numbers" checked> Include Numbers (0-9)</label>
            
            <label><input type="checkbox" id="custom"> Custom Characters</label>
            <div id="custom-char-container">
                <input type="text" id="customInput" placeholder="Enter chars (e.g. @@@###)">
                <small style="display:block; color:#888; margin-top:2px;">Repeated chars increase probability.</small>
            </div>

            <div id="special-group">
                <label><input type="checkbox" id="special" checked> Include Special [-_.]</label>
                <label><input type="checkbox" id="all"> Include All ( !"#$%&'()*+,/:;<=>?@[\\]^{}|~)</label>
            </div>
        </div>

        <div class="btn-group">
            <button id="generateBtn" onclick="generatePassword()">Generate</button>
            <button id="copyBtn" onclick="copyPassword()">Copy</button>
        </div>
        
        <input type="text" id="password" readonly placeholder="...">

        <div class="stats">
            <div class="stat-line">
                <span class="stat-label">Combinations:</span><br>
                <span id="stat-decimal">-</span> <br>
                <span id="stat-binary" style="font-family: monospace;">-</span>
            </div>
            <div class="stat-line">
                <span class="stat-label">Time to Crack:</span><br>
                Modern Computer: <span id="time-modern">-</span><br>
                Quantum Computer: <span id="time-quantum">-</span>
            </div>
        </div>
    </div>

    <script>
        const MODERN_GUESSES_PER_SEC = 100_000_000_000; 

        document.querySelector('.container').addEventListener('input', function(e) {
            if (e.target.id === 'custom') {
                const customContainer = document.getElementById('custom-char-container');
                const specialGroup = document.getElementById('special-group');
                if (e.target.checked) {
                    customContainer.style.display = 'block';
                    specialGroup.classList.add('hidden');
                } else {
                    customContainer.style.display = 'none';
                    specialGroup.classList.remove('hidden');
                }
            }
            updateStats();
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                generatePassword();
            }
        });

        function formatTime(seconds) {
            if (seconds === Infinity) return "Forever";
            if (seconds < 1) return "Instant";
            
            const minute = 60;
            const hour = minute * 60;
            const day = hour * 24;
            const year = day * 365.25;

            if (seconds < minute) return Math.round(seconds) + " seconds";
            if (seconds < hour) return Math.round(seconds / minute) + " minutes";
            if (seconds < day) return Math.round(seconds / hour) + " hours";
            if (seconds < year) return Math.round(seconds / day) + " days";

            let years = seconds / year;
            return years.toString().split('.')[0] + " years";
        }

        function getPoolSettings() {
            const length = parseInt(document.getElementById('length').value) || 16;
            const includeUppercase = document.getElementById('uppercase').checked;
            const includeLowercase = document.getElementById('lowercase').checked;
            const includeNumbers = document.getElementById('numbers').checked;
            const isCustom = document.getElementById('custom').checked;
            
            let charset = '';
            
            if (includeUppercase) charset += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            if (includeLowercase) charset += 'abcdefghijklmnopqrstuvwxyz';
            if (includeNumbers) charset += '0123456789';

            if (isCustom) {
                const customChars = document.getElementById('customInput').value;
                charset += customChars; 
            } else {
                const includeSpecial = document.getElementById('special').checked;
                const includeAll = document.getElementById('all').checked;
                if (includeSpecial) charset += '-_.';
                if (includeAll) charset += ` !"#$%&'()*+,/:;<=>?@[\\]^{}|~`;
            }

            return { charset, length };
        }

        function updateStats() {
            const { charset, length } = getPoolSettings();
            const poolSize = charset.length;

            let totalCombinations = BigInt(0);
            
            try {
                if (poolSize > 0 && length > 0) {
                    totalCombinations = BigInt(poolSize) ** BigInt(length);
                }
            } catch (e) {}

            let decString = totalCombinations.toLocaleString();
            if (decString.length > 25) {
                decString = decString.substring(0, 20) + "... (" + decString.length + " digits)";
            }
            document.getElementById('stat-decimal').textContent = decString;

            if (poolSize === 0) {
                document.getElementById('stat-binary').textContent = "0 bits";
                document.getElementById('time-modern').textContent = "-";
                document.getElementById('time-quantum').textContent = "-";
                return;
            }

            const entropyBits = Math.floor(length * Math.log2(poolSize));
            document.getElementById('stat-binary').textContent = "2^" + entropyBits;

            const log10N = length * Math.log10(poolSize);
            const log10ModernSpeed = Math.log10(MODERN_GUESSES_PER_SEC);
            
            const log10ModernSeconds = log10N - log10ModernSpeed;
            const log10QuantumSeconds = (0.5 * log10N) - log10ModernSpeed;

            const displayTime = (logSeconds) => {
                if (logSeconds < 0) return "Instant";
                if (logSeconds < 15) {
                    return formatTime(Math.pow(10, logSeconds));
                }
                const logYears = logSeconds - 7.5;
                return "10^" + Math.floor(logYears) + " years";
            };

            console.log(log10QuantumSeconds);

            document.getElementById('time-modern').textContent = displayTime(log10ModernSeconds);
            document.getElementById('time-quantum').textContent = displayTime(log10QuantumSeconds);
        }

        function generatePassword() {
            const { charset, length } = getPoolSettings();

            if (charset.length === 0) {
                alert('Please select at least one character set or enter custom characters.');
                return;
            }

            let password = '';
            const array = new Uint32Array(length);
            if (window.crypto && window.crypto.getRandomValues) {
                window.crypto.getRandomValues(array);
                for (let i = 0; i < length; i++) {
                    password += charset[array[i] % charset.length];
                }
            } else {
                for (let i = 0; i < length; i++) {
                    const randomIndex = Math.floor(Math.random() * charset.length);
                    password += charset[randomIndex];
                }
            }
            document.getElementById('password').value = password;
        }

        function copyPassword() {
            const inp = document.getElementById('password');
            if (!inp || !inp.value) return;
            const text = inp.value;
            const done = () => {
                const b = document.getElementById('copyBtn');
                if (!b) return;
                const prev = b.textContent;
                b.textContent = 'Copied';
                setTimeout(() => b.textContent = prev || 'Copy', 1000);
                
                inp.classList.remove('blink');
                void inp.offsetWidth; 
                inp.classList.add('blink');

                try { inp.blur(); } catch (e) { }
            };
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(done).catch(fallback);
                return;
            }
            fallback();
            function fallback() {
                try {
                    inp.focus({ preventScroll: true });
                    if (typeof inp.select === 'function') { inp.select(); if (inp.setSelectionRange) inp.setSelectionRange(0, text.length); }
                    if (document.execCommand && document.execCommand('copy')) return done();
                } catch (e) { }
                const ta = document.createElement('textarea');
                ta.value = text;
                Object.assign(ta.style, { position: 'fixed', top: 0, left: 0, width: '1px', height: '1px', padding: 0, border: 0, outline: 0 });
                document.body.appendChild(ta); ta.focus(); ta.select();
                try { document.execCommand('copy'); } catch (e) { }
                document.body.removeChild(ta);
                done();
            }
        }
        
        updateStats();
    </script>

</body>

</html>
